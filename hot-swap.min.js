function HotSwap(t,n){this.init=function(){document.addEventListener("click",this.onHotSwapClick.bind(this)),window.addEventListener("popstate",this.onHotSwapStateChange.bind(this)),window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""))},this.onHotSwapClick=function(t){var n=t.target;do{if(null===n||"a"===n.nodeName.toLowerCase())break;n=n.parentNode}while(n);n&&n.href&&this.isSameOriginCurrentPage(n.href)&&!this.isHrefCurrentPage(n.href)&&(t.preventDefault(),this.hotSwapUrl(n.href))},this.hotSwapUrl=function(t){var n={scrollY:window.scrollY};return window.history.replaceState(n,null,window.location.href),window.history.pushState(null,null,t),this.onHotSwapStateChange()},this.onHotSwapStateChange=function(n){Promise.all([this.hotSwapLoadNewPath(n),t()]).then(function(t){this.onHotSwapLoadSuccess(t[0],n)}.bind(this))},this.hotSwapLoadNewPath=function(t){return new Promise(function(t,n){var o=window.location.pathname+window.location.search,e=new XMLHttpRequest;e.onload=function(n){t(n)},e.onerror=n,e.open("get",o),e.responseType="document",e.send()})},this.onHotSwapLoadSuccess=function(t,o){var e=t.target.response;n(e).then(function(){if(o&&o.state)window.scrollTo(0,o.state.scrollY);else if(this.hasUrlHashParameter(window.location.href)){var t=document.getElementById(this.getUrlHashParameter(window.location.href).substr(1));window.scrollTo(0,t.offsetTop)}else window.scrollTo(0,0)}.bind(this))},this.getUrlNoParameters=function(t){var n=t,o=t.indexOf("?"),e=t.indexOf("#"),i=-1;return(o>0||e>0)&&(i=o>0&&e<0?o:o<0&&e>0?e:Math.min(o,e),n=n.substr(0,i)),n},this.isHrefCurrentPage=function(t){var n=this.getUrlNoParameters(window.location.href),o=this.getUrlNoParameters(t);return n==o},this.isSameOriginCurrentPage=function(t){return 0===t.indexOf(window.location.origin)},this.hasUrlHashParameter=function(t){return t.indexOf("#")>0},this.getUrlHashParameter=function(t){return t.substr(t.indexOf("#"))}}